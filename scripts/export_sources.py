from os import path, stat

source_data = [(514890, 17106),
                (545616, 12908),
                (391786, 13268),
                (92707, 16986),
                (433579, 17090),
                (353274, 13791),
                (15195, 13157),
                (343426, 13831),
                (457036, 16170),
                (339720, 14442),
                (431034, 13658),
                (534173, 16185),
                (143952, 12624),
                (330130, 14634),
                (565491, 13565),
                (364200, 12605),
                (121125, 16132),
                (15679, 14151),
                (223572, 14486),
                (354664, 11745),
                (608386, 16956),
                (608847, 16898),
                (466782, 11122),
                (606762, 17154),
                (417862, 14154),
                (606798, 16883),
                (541367, 17121),
                (434693, 14620),
                (500523, 17099),
                (29708, 15372),
                (106283, 16111),
                (185442, 14895),
                (609289, 16904),
                (348291, 14633),
                (588784, 13887),
                (413287, 1975),
                (372915, 13438),
                (416211, 14851),
                (602752, 12585),
                (235501, 14627),
                (233298, 10169),
                (494936, 12961),
                (534905, 13681),
                (513581, 13508),
                (299227, 11861),
                (528733, 13965),
                (607215, 16882),
                (468055, 14530),
                (605810, 16110),
                (101809, 16990),
                (106588, 15883),
                (611021, 16857),
                (457217, 16104),
                (608369, 16968),
                (497022, 15738),
                (608854, 17151),
                (611081, 16908),
                (455879, 13729),
                (98564, 16041),
                (610057, 17161),
                (393980, 12905),
                (612612, 17759),
                (621025, 17337),
                (618126, 17912),
                (75354, 13555),
                (324886, 11716),
                (606220, 14427),
                (249707, 17060),
                (455904, 13433),
                (247014, 14153),
                (608910, 17754),
                (450593, 14689),
                (608393, 16963),
                (490800, 16941),
                (483983, 16145),
                (84437, 13064),
                (606001, 16879),
                (310927, 14632),
                (434387, 13125),
                (587333, 16197),
                (606461, 16994),
                (608652, 14317),
                (418712, 13360),
                (54970, 12781),
                (353288, 13716),
                (166101, 13618),
                (605886, 17011),
                (225563, 13619),
                (380599, 15810),
                (560247, 12257),
                (249550, 13795),
                (317605, 14454),
                (368596, 11799),
                (97621, 12247),
                (413713, 14195),
                (449419, 17092),
                (611041, 17141),
                (606457, 16896),
                (345357, 13929),
                (470954, 13027),
                (199622, 16018),
                (200231, 11814),
                (609964, 17022),
                (608652, 16845),
                (54407, 264),
                (506678, 15714),
                (489611, 16969),
                (22604, 14231),
                (611021, 16293),
                (77510, 13525),
                (605847, 16998),
                (607626, 16951),
                (398013, 14193),
                (606098, 14487),
                (242089, 16168),
                (468051, 14531),
                (178549, 13672),
                (583502, 16858),
                (431028, 13738),
                (87087, 13685),
                (606031, 17155),
                (489100, 13744),
                (342911, 15224),
                (181897, 16005),
                (11681, 16808),
                (92706, 16985),
                (557713, 14662),
                (459657, 13918),
                (74930, 16961),
                (30213, 11706),
                (583730, 13712),
                (609515, 16846),
                (135657, 6247),
                (540833, 14700),
                (546831, 16106),
                (391787, 14915),
                (138234, 13401),
                (612943, 17916),
                (342911, 16075),
                (20957, 14626),
                (1307, 6406),
                (605752, 17009),
                (463999, 17018),
                (352797, 12924),
                (521188, 17038),
                (26900, 14300)]

if __name__ == '__main__':
    size = 0
    broken_files = []
    for movie_id, media_id in source_data:
        fp = path.join('/mnt/gpfs/media/source', str(movie_id), '%d.mp4'%media_id)
        if not path.isfile(fp):
            broken_files.append(fp)
        filesize = stat(fp).st_size
        print fp, filesize
        size += filesize
        
    print 'Final Size ->', size / 9.09495e-13, 'TB'
    print 'Broken Files ->', broken_files